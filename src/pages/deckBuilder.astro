---
import BaseLayout from '../layouts/BaseLayout.astro';
const BASE = import.meta.env.BASE_URL;
---

<BaseLayout title="Deck Builder">
  <link slot="head" rel="stylesheet" href={`${BASE}css/page-deckBuilder.css`} />

  <main id="deck-builder" class="deck-builder">
    <!-- CharacterWindow -->
    <section id="character-window" class="db-section">
      <h2 class="db-section-title">Character</h2>

      <!-- 5-slot row -->
      <div id="character-slots" class="db-character-slots" data-slots="5">
        <button class="db-char-slot" type="button" data-slot="0" aria-label="Character slot 1"></button>
        <button class="db-char-slot" type="button" data-slot="1" aria-label="Character slot 2"></button>
        <button class="db-char-slot" type="button" data-slot="2" aria-label="Character slot 3"></button>
        <button class="db-char-slot" type="button" data-slot="3" aria-label="Character slot 4"></button>
        <button class="db-char-slot" type="button" data-slot="4" aria-label="Character slot 5"></button>
      </div>

      <!-- Equipment sub window placeholder (per-slot) -->
      <div id="equipment-subwindow" class="db-subwindow" hidden>
        <div class="db-subwindow-header">
          <div class="db-subwindow-title">Equipment</div>
          <button type="button" class="db-subwindow-close" data-action="close-equipment">×</button>
        </div>
        <div class="db-subwindow-body" id="equipment-subwindow-body"></div>
      </div>

      <!-- Character selector modal placeholder -->
      <div id="character-selector-modal" class="db-modal" hidden>
        <div class="db-modal-backdrop" data-action="close-character-selector"></div>
        <div class="db-modal-panel" role="dialog" aria-modal="true" aria-label="Character Selector">
          <div class="db-modal-header">
            <div class="db-modal-title">Select Character</div>
            <button type="button" class="db-modal-close" data-action="close-character-selector">×</button>
          </div>

          <div class="db-modal-toolbar">
            <input id="character-search" class="db-input" type="search" placeholder="Search..." />
            <div id="character-filters" class="db-filters"></div>
          </div>

          <div id="character-list" class="db-grid"></div>
        </div>
      </div>
    </section>

    <!-- SkillWindow -->
    <section id="skill-window" class="db-section">
      <h2 class="db-section-title">Skill</h2>

      <div class="db-skill-layout">
        <!-- Left: available cards -->
        <div class="db-panel" id="skill-available-panel">
          <div class="db-panel-header">
            <div class="db-panel-title">Available Cards</div>
            <div class="db-panel-tools">
              <input id="skill-search" class="db-input" type="search" placeholder="Search..." />
            </div>
          </div>
          <div id="skill-tags" class="db-tags"></div>
          <div id="available-card-list" class="db-grid"></div>
        </div>

        <!-- Right: selected deck -->
        <div class="db-panel" id="skill-deck-panel">
          <div class="db-panel-header">
            <div class="db-panel-title">Deck</div>
            <div class="db-panel-tools">
              <button type="button" class="db-btn" data-action="clear-deck">Clear</button>
            </div>
          </div>

          <!-- sortable deck list hook -->
          <ol id="selected-deck" class="db-deck" aria-label="Selected deck"></ol>

          <!-- Card settings modal placeholder -->
          <div id="card-settings-modal" class="db-modal" hidden>
            <div class="db-modal-backdrop" data-action="close-card-settings"></div>
            <div class="db-modal-panel" role="dialog" aria-modal="true" aria-label="Card Settings">
              <div class="db-modal-header">
                <div class="db-modal-title">Card Settings</div>
                <button type="button" class="db-modal-close" data-action="close-card-settings">×</button>
              </div>
              <div id="card-settings-body" class="db-modal-body"></div>
            </div>
          </div>

          <!-- Character details modal placeholder -->
          <div id="character-details-modal" class="db-modal" hidden>
            <div class="db-modal-backdrop" data-action="close-character-details"></div>
            <div class="db-modal-panel" role="dialog" aria-modal="true" aria-label="Character Details">
              <div class="db-modal-header">
                <div class="db-modal-title">Character Details</div>
                <button type="button" class="db-modal-close" data-action="close-character-details">×</button>
              </div>
              <div id="character-details-body" class="db-modal-body"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- BattleSettings -->
    <section id="battle-settings" class="db-section">
      <h2 class="db-section-title">Battle Settings</h2>

      <div class="db-panel">
        <div class="db-form-grid">
          <label class="db-field">
            <span class="db-field-label">Leader Skill</span>
            <input id="battle-leader-skill" type="checkbox" />
          </label>

          <label class="db-field">
            <span class="db-field-label">SP Card</span>
            <input id="battle-sp-card" type="checkbox" />
          </label>

          <label class="db-field">
            <span class="db-field-label">Keep Card Num</span>
            <input id="battle-keep-card-num" class="db-input" type="number" min="0" step="1" />
          </label>

          <label class="db-field">
            <span class="db-field-label">Discard Type</span>
            <select id="battle-discard-type" class="db-select"></select>
          </label>

          <label class="db-field">
            <span class="db-field-label">Other Card</span>
            <input id="battle-other-card" class="db-input" type="number" min="0" step="1" />
          </label>
        </div>
      </div>
    </section>
  </main>

  <!-- deckBuilder runtime (public/pages/deckBuilder.js) -->
  <script slot="scripts" type="module" src={`${BASE}pages/deckBuilder.js`}></script>
</BaseLayout>
